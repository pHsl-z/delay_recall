# 日托学生使用说明

## 概述
日托学生采用按天计费模式，根据预购买的托管天数提供服务。系统会自动管理天数消耗、到期提醒和状态变更。

## 一、日托学生基本特征

### 1.1 标识方式
- **学生类型**：`student_type` 字段值为 `"日托"`
- **视觉标识**：蓝色标签显示，文字为"日托"
- **单价设置**：通过系统设置中的 `dailyCarePrice` 配置，默认59元/天

### 1.2 专属字段
```javascript
{
  student_type: "日托",
  daycare_days: "剩余托管天数",
  monthly_payment: "总费用",
  daily_consumption: "日单价",
  next_renewal_date: "缴费截止日期",
  status: "学生状态"  // active:在读, suspended:暂停
}
```

## 二、日托学生录入流程

### 2.1 添加新学生
1. 点击"添加学生"按钮
2. 填写基本信息（姓名、年级、班级等）
3. 选择学生类型为"日托"
4. 设置托管天数（支持快捷选择和自定义输入）

### 2.2 天数设置方式
- **快捷按钮**：提供5天、10天快捷选择
- **自定义输入**：手动输入任意天数（0-365天）
- **费用计算**：系统自动计算总费用 = 天数 × 单价

### 2.3 缴费日期计算
- **工作日计算**：按工作日计算缴费期限，排除周末和节假日
- **算法规则**：
  - 托管1天：缴费日期为当天
  - 托管多天：使用工作日算法计算截止日期

## 三、日常运营管理

### 3.1 考勤签到机制
- **自动签到**：工作日17:40自动创建考勤记录
- **手动签到**：支持手动签到和补签
- **天数消耗**：每次签到后自动减少1天剩余天数

### 3.2 天数监控流程
```
学生签到 → 验证工作日 → 创建考勤记录 → daycare_days减1 → 检查剩余天数
                                                            ↓
                                                    剩余天数≤0 → 自动暂停
```

### 3.3 自动暂停机制
#### 情况一：天数用完
- **触发条件**：`daycare_days ≤ 0`
- **执行操作**：
  - 学生状态更新为 `suspended`
  - 显示提示："学生XXX日托天数用完，已自动暂停"
  - 停用相关缴费记录

#### 情况二：缴费期限过期
- **检查频率**：每小时自动检查一次
- **检查逻辑**：比较 `next_renewal_date` 与当前日期
- **暂停条件**：缴费日期已过且状态为在读
- **执行操作**：
  - 学生状态更新为 `suspended`
  - 显示警告提示
  - 停用缴费记录

## 四、状态管理操作

### 4.1 手动状态变更
1. 在学生列表中找到目标学生
2. 点击状态下拉菜单
3. 选择新的状态（暂停/在读/转学/退学/毕业）
4. 系统会自动同步更新相关缴费记录状态

### 4.2 重新入学流程
- **触发条件**：非活动状态改为"在读"时
- **确认流程**：弹出重新入学确认对话框
- **执行操作**：确认后更新状态并激活缴费记录

## 五、费用处理原则

### 5.1 计费模式
- **预付费制**：费用在缴费时一次性确定
- **按天消耗**：每天签到消耗1天托管服务
- **不退费政策**：暂停后不返还剩余费用，仅停止后续服务

### 5.2 余额计算
- **当前实现**：系统返回固定值0，不计算实时余额
- **费用确认**：总费用 = 托管天数 × 日单价（缴费时确定）

## 六、系统设置与配置

### 6.1 日托单价设置
- **设置路径**：系统设置 → 基础配置
- **配置项**：`dailyCarePrice`（默认59元/天）
- **影响范围**：影响所有日托学生的费用计算

### 6.2 提醒设置
- **续费提醒**：支持设置提前提醒天数（0天/3天/7天）
- **过期检查**：每小时自动检查缴费期限

## 七、注意事项与最佳实践

### 7.1 重要提醒
⚠️ **日托学生暂停后不会暂停计费**，因为费用已在缴费时确定
⚠️ **天数为0时必须重新缴费才能恢复服务**
⚠️ **工作日计算会影响缴费截止日期**，周末和节假日不计算在内

### 7.2 操作建议
- 定期检查日托学生的剩余天数
- 及时提醒家长续费，避免服务中断
- 关注系统自动发送的到期提醒
- 手动暂停前确认剩余天数情况

### 7.3 常见问题
**Q: 日托学生暂停后会退费吗？**
A: 不会退费，日托采用预付费模式，费用在缴费时已确定。

**Q: 为什么日托学生的缴费日期计算与其他类型不同？**
A: 日托按工作日计算，排除周末和节假日；月托和学期按自然日计算。

**Q: 学生暂停后如何恢复？**
A: 需要重新缴费购买托管天数，然后将状态改为"在读"。

## 八、相关功能入口
- **学生管理**：添加、编辑、状态变更
- **考勤管理**：签到记录、补签操作
- **系统设置**：日托单价配置、提醒设置
- **缴费管理**：缴费记录查看、状态管理

---

*本说明基于系统当前实现整理，如有功能更新请以实际系统为准。*